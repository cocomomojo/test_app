# 📁 4. リポジトリ構造

このセクションでは、プロジェクトのディレクトリ構成と各ファイルの役割について説明します。

---

## 🌳 プロジェクト全体構成

```
test_app/
├── 📄 README.md                       # プロジェクト全体の説明
├── 📄 Todo.md                         # タスク管理
├── 📄 build.gradle                    # Gradle ビルド設定（ルート）
│
├── 📁 backend/                        # Spring Boot バックエンド
│   ├── 📄 build.gradle                # Gradle ビルド設定
│   ├── 📄 Dockerfile                  # Docker イメージ定義
│   ├── 📄 Dockerfile.init             # 初期化用 Docker イメージ
│   ├── 📄 HELP.md                     # Spring Boot 関連ドキュメント
│   ├── 📄 settings.gradle             # Gradle マルチプロジェクト設定
│   ├── 📄 gradlew                     # Linux/Mac 用 Gradle Wrapper
│   ├── 📄 gradlew.bat                 # Windows 用 Gradle Wrapper
│   │
│   ├── 📁 gradle/
│   │   └── wrapper/                   # Gradle ラッパーファイル
│   │
│   └── 📁 src/
│       └── main/
│           ├── 📁 java/
│           │   └── com/example/project/
│           │       ├── BackendApplication.java     # メインアプリケーション
│           │       │
│           │       ├── 📁 controller/              # リクエストハンドラー
│           │       │   ├── AuthController.java     # 認証エンドポイント
│           │       │   ├── MemoController.java     # メモ管理エンドポイント
│           │       │   └── (TodoController.java)   # ToDo エンドポイント
│           │       │
│           │       ├── 📁 service/                 # ビジネスロジック
│           │       │   ├── MemoService.java        # メモ管理ロジック
│           │       │   ├── TodoService.java        # ToDo 管理ロジック
│           │       │   └── FileService.java        # ファイル操作ロジック
│           │       │
│           │       ├── 📁 entity/                  # JPA エンティティ
│           │       │   ├── Todo.java               # ToDo テーブルマッピング
│           │       │   ├── Memo.java               # メモテーブルマッピング
│           │       │   ├── User.java               # ユーザーテーブルマッピング
│           │       │   └── (BaseEntity.java)       # 基本エンティティ
│           │       │
│           │       ├── 📁 repository/              # データアクセス層
│           │       │   ├── TodoRepository.java     # ToDo リポジトリ
│           │       │   ├── MemoRepository.java     # メモリポジトリ
│           │       │   ├── UserRepository.java     # ユーザーリポジトリ
│           │       │   └── (CustomRepository.java) # カスタム実装
│           │       │
│           │       ├── 📁 dto/                     # データ転送オブジェクト
│           │       │   ├── TodoDTO.java            # ToDo DTO
│           │       │   ├── MemoDTO.java            # メモ DTO
│           │       │   ├── AuthRequest.java        # ログインリクエスト
│           │       │   └── ApiResponse.java        # API レスポンス
│           │       │
│           │       ├── 📁 security/                # セキュリティ関連
│           │       │   ├── LocalAuthFilter.java    # 認証フィルター
│           │       │   ├── AudienceValidator.java  # トークン検証
│           │       │   └── JwtTokenProvider.java   # JWT 生成・検証
│           │       │
│           │       ├── 📁 config/                  # アプリケーション設定
│           │       │   ├── SecurityConfig.java     # Spring Security 設定
│           │       │   ├── AWSConfig.java          # AWS SDK 設定
│           │       │   ├── WebConfig.java          # Web MVC 設定
│           │       │   └── CorsConfig.java         # CORS 設定
│           │       │
│           │       ├── 📁 exception/               # カスタム例外
│           │       │   ├── ResourceNotFoundException.java
│           │       │   ├── UnauthorizedException.java
│           │       │   └── GlobalExceptionHandler.java
│           │       │
│           │       ├── 📁 top/                     # トップページ用
│           │       │   ├── TopController.java      # トップページコントローラー
│           │       │   └── TopResponse.java        # レスポンス定義
│           │       │
│           │       └── 📁 util/                    # ユーティリティ
│           │           ├── DateUtils.java          # 日付ユーティリティ
│           │           ├── FileUtils.java          # ファイルユーティリティ
│           │           └── ValidationUtils.java    # バリデーションユーティリティ
│           │
│           └── resources/
│               ├── 📄 application.yml              # 基本設定
│               ├── 📄 application-local.yml        # ローカル開発設定
│               ├── 📄 application-ci.yml           # CI 環境設定
│               ├── 📁 static/                      # 静的ファイル（CSS, JS）
│               ├── 📁 templates/                   # Thymeleaf テンプレート
│               ├── 📁 db/
│               │   ├── migration/                  # Flyway マイグレーション
│               │   ├── data.sql                    # 初期データ
│               │   └── schema.sql                  # テーブル定義
│               └── logback.xml                     # ログ設定
│
├── 📁 frontend/                       # Vue.js フロントエンド
│   ├── 📄 package.json                # npm 依存関係
│   ├── 📄 tsconfig.json               # TypeScript 設定
│   ├── 📄 vite.config.js              # Vite ビルド設定
│   ├── 📄 playwright.config.ts        # Playwright テスト設定
│   ├── 📄 nginx.conf                  # Nginx 設定（本番）
│   ├── 📄 Dockerfile                  # Docker イメージ定義
│   ├── 📄 index.html                  # メイン HTML
│   │
│   ├── 📁 src/
│   │   ├── 📄 main.js                 # アプリケーション起点
│   │   ├── 📄 App.vue                 # ルートコンポーネント
│   │   │
│   │   ├── 📁 components/             # 再利用可能コンポーネント
│   │   │   ├── Header.vue             # ヘッダーコンポーネント
│   │   │   ├── Sidebar.vue            # サイドバー
│   │   │   ├── Footer.vue             # フッター
│   │   │   ├── TodoList.vue           # ToDo リスト表示
│   │   │   ├── TodoForm.vue           # ToDo フォーム
│   │   │   ├── MemoList.vue           # メモリスト表示
│   │   │   ├── MemoForm.vue           # メモフォーム
│   │   │   └── Modal.vue              # モーダルダイアログ
│   │   │
│   │   ├── 📁 pages/                  # ページコンポーネント
│   │   │   ├── Login.vue              # ログインページ
│   │   │   ├── Dashboard.vue          # ダッシュボード
│   │   │   ├── TodoPage.vue           # ToDo 管理ページ
│   │   │   ├── MemoPage.vue           # メモ管理ページ
│   │   │   ├── NotFound.vue           # 404 ページ
│   │   │   └── Unauthorized.vue       # 401 ページ
│   │   │
│   │   ├── 📁 api/                    # API クライアント
│   │   │   ├── client.js              # Axios インスタンス
│   │   │   ├── auth.js                # 認証 API
│   │   │   ├── todo.js                # ToDo API
│   │   │   ├── memo.js                # メモ API
│   │   │   └── upload.js              # ファイルアップロード API
│   │   │
│   │   ├── 📁 router/                 # Vue Router 定義
│   │   │   ├── index.js               # ルート定義
│   │   │   └── guards.js              # ナビゲーションガード
│   │   │
│   │   ├── 📁 store/                  # 状態管理（Vuex/Composition API）
│   │   │   ├── index.js               # ストア定義
│   │   │   ├── auth.js                # 認証モジュール
│   │   │   ├── todo.js                # ToDo モジュール
│   │   │   └── memo.js                # メモモジュール
│   │   │
│   │   ├── 📁 utils/                  # ユーティリティ
│   │   │   ├── formatter.js           # フォーマッティング
│   │   │   ├── validators.js          # バリデーション
│   │   │   └── helpers.js             # ヘルパー関数
│   │   │
│   │   ├── 📁 assets/                 # 静的アセット
│   │   │   ├── images/                # 画像ファイル
│   │   │   ├── icons/                 # アイコン
│   │   │   └── styles/                # グローバルスタイル
│   │   │
│   │   └── 📁 styles/                 # CSS ファイル
│   │       ├── global.css             # グローバルスタイル
│   │       └── variables.css           # CSS 変数
│   │
│   ├── 📁 tests/
│   │   ├── 📁 e2e/                    # E2E テスト（Playwright）
│   │   │   ├── login.spec.ts          # ログインテスト
│   │   │   ├── todo.spec.ts           # ToDo 操作テスト
│   │   │   ├── memo.spec.ts           # メモ操作テスト
│   │   │   └── common.spec.ts         # 共通テスト
│   │   │
│   │   ├── 📁 unit/                   # ユニットテスト（オプション）
│   │   │   └── utils.test.js
│   │   │
│   │   └── fixtures/                  # テストフィクスチャ
│   │       ├── user.json              # テストユーザーデータ
│   │       └── testdata.json           # テストデータ
│   │
│   ├── 📁 allure-results/             # Allure テストレポート結果
│   ├── 📁 playwright-report/          # Playwright テストレポート
│   ├── 📁 test-results/               # テスト実行結果ログ
│   └── 📁 asset/                      # アセットファイル
│
├── 📁 infra/                          # インフラストラクチャ設定
│   ├── 📄 docker-compose.local.yml    # ローカル開発用 Docker Compose
│   ├── 📄 docker-compose.ci.yml       # CI 環境用 Docker Compose
│   │
│   └── 📁 localstack/
│       ├── 📄 docker-compose.yml      # LocalStack 構成
│       ├── 📄 init-aws.sh             # AWS CLI 初期化スクリプト
│       └── 📄 s3-init.json            # S3 バケット設定
│
├── 📁 .github/
│   ├── 📁 workflows/
│   │   ├── 📄 e2e.yml                 # E2E テスト CI ワークフロー
│   │   ├── 📄 build.yml               # ビルド CI ワークフロー
│   │   └── 📄 deploy.yml              # デプロイ CD ワークフロー
│   │
│   └── 📁 ISSUE_TEMPLATE/             # Issue テンプレート
│
├── 📁 docs/                           # ドキュメント（オプション）
│   ├── 📄 API.md                      # API 仕様
│   ├── 📄 DATABASE.md                 # DB スキーマ
│   └── 📄 SETUP.md                    # セットアップガイド
│
├── 📁 wiki/                           # Wiki ドキュメント
│   ├── 📄 00-目次.md                  # 目次
│   ├── 📄 01-概要.md                  # 概要
│   ├── 📄 02-クイックスタート.md
│   ├── 📄 03-アーキテクチャ.md
│   ├── 📄 04-リポジトリ構造.md
│   └── ... (その他のドキュメント)
│
├── 📁 生成指示書/                      # ドキュメント生成指示
│   ├── 📄 ドキュメント指示書.md        # 生成手順
│   └── 📄 ドキュメント構成.md          # 構成定義
│
└── 📄 .gitignore                      # Git 除外設定
```

---

## 📂 ディレクトリ詳細説明

### Backend ディレクトリ

#### `src/main/java/com/example/project/`

| ディレクトリ | 役割 | 説明 |
|-------------|------|------|
| **controller/** | HTTP リクエスト処理 | REST API エンドポイント定義、リクエスト/レスポンス処理 |
| **service/** | ビジネスロジック | 業務ロジック実装、トランザクション管理、例外処理 |
| **entity/** | ドメインモデル | JPA エンティティ、テーブル構造定義 |
| **repository/** | データアクセス | JPA Repository、SQL クエリ定義 |
| **dto/** | データ転送 | リクエスト/レスポンス DTO、API 契約定義 |
| **security/** | セキュリティ | 認証フィルター、JWT 検証、セキュリティ設定 |
| **config/** | アプリケーション設定 | Spring Configuration、外部サービス設定 |
| **exception/** | 例外処理 | カスタム例外、グローバルエラーハンドラー |
| **util/** | ユーティリティ | ヘルパー関数、共通処理 |

#### `src/main/resources/`

| ファイル | 用途 |
|---------|------|
| `application.yml` | デフォルト設定ファイル |
| `application-local.yml` | ローカル開発設定（ポート、DB 設定） |
| `application-ci.yml` | CI 環境設定（Docker 環境用） |
| `data.sql` | 初期データの挿入スクリプト |
| `schema.sql` | テーブル定義 |
| `logback.xml` | ログ出力設定 |

### Frontend ディレクトリ

#### `src/`

| ディレクトリ | 役割 | 説明 |
|-------------|------|------|
| **components/** | 再利用コンポーネント | ヘッダー、フッター、モーダルなど |
| **pages/** | ページコンポーネント | ログイン、ダッシュボード、管理ページ |
| **api/** | API クライアント | axios インスタンス、API 通信処理 |
| **router/** | ルーティング | ページ遷移、ナビゲーション定義 |
| **store/** | 状態管理 | Vuex/Composition API、グローバル状態 |
| **utils/** | ユーティリティ | バリデーション、フォーマッティング |
| **assets/** | 静的リソース | 画像、アイコン |
| **styles/** | CSS | グローバルスタイル、テーマ |

#### `tests/`

| ディレクトリ | 役割 | 説明 |
|-------------|------|------|
| **e2e/** | E2E テスト | Playwright によるエンドツーエンドテスト |
| **unit/** | ユニットテスト | 個別関数のテスト（オプション） |
| **fixtures/** | テストデータ | テスト用のモックデータ |

### インフラディレクトリ

| ファイル | 用途 |
|---------|------|
| `docker-compose.local.yml` | ローカル開発環境（全サービス：Backend、Frontend、MySQL、LocalStack） |
| `docker-compose.ci.yml` | CI 環境（テスト実行環境） |

---

## 📊 主要ファイル説明

### Backend 主要ファイル

#### [BackendApplication.java](../backend/src/main/java/com/example/project/BackendApplication.java)
Spring Boot アプリケーションのエントリーポイント。`@SpringBootApplication` アノテーションで自動設定。

#### [application-local.yml](../backend/src/main/resources/application-local.yml)
ローカル開発環境の設定。ポート、DB 接続、プロファイル設定。

#### Controller 層
- `TodoController.java` - ToDo CRUD エンドポイント
- `MemoController.java` - メモ CRUD エンドポイント
- `AuthController.java` - ログイン・ログアウト

#### Service 層
- `TodoService.java` - ToDo ビジネスロジック
- `MemoService.java` - メモビジネスロジック
- `FileService.java` - ファイルアップロード・ダウンロード

### Frontend 主要ファイル

#### [main.js](../frontend/src/main.js)
Vue アプリケーションのエントリーポイント。Vue インスタンス、ルーター、ストア初期化。

#### [router/index.js](../frontend/src/router/index.js)
Vue Router ルート定義。ページ遷移、ナビゲーションガード。

#### [api/client.js](../frontend/src/api/client.js)
Axios インスタンス設定。API 基本 URL、認証トークン、インターセプター。

#### Pages
- `Login.vue` - ログイン画面
- `Dashboard.vue` - ダッシュボード
- `TodoPage.vue` - ToDo 管理画面
- `MemoPage.vue` - メモ管理画面

---

## 📋 主要な設定ファイル

### Backend

| ファイル | 説明 |
|---------|------|
| `build.gradle` | ビルド設定、依存ライブラリ定義 |
| `Dockerfile` | Docker イメージ構築定義 |
| `application.yml` | Spring Boot デフォルト設定 |
| `application-local.yml` | ローカル開発設定 |

### Frontend

| ファイル | 説明 |
|---------|------|
| `package.json` | npm 依存関係、スクリプト定義 |
| `tsconfig.json` | TypeScript 設定 |
| `vite.config.js` | Vite ビルドツール設定 |
| `playwright.config.ts` | Playwright テスト設定 |
| `nginx.conf` | 本番環境 Nginx 設定 |

### Docker

| ファイル | 説明 |
|---------|------|
| `infra/docker-compose.local.yml` | ローカル環境（開発用） |
| `infra/docker-compose.ci.yml` | CI 環境（テスト用） |

---

## 📚 次のステップ

- [データモデル](./05-データモデル.md) - テーブル構造と ER 図
- [コアコンポーネント](./06-コアコンポーネント.md) - 主要クラス解説
- [APIドキュメント](./07-APIドキュメント.md) - エンドポイント仕様
